(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[365],{33741:(e,t,r)=>{"use strict";r.d(t,{$5:()=>n,M3:()=>a,Vv:()=>d,iD:()=>l,qo:()=>m,ri:()=>c,tK:()=>g});let s="/api";function o(){return localStorage.getItem("foldr_auth_token")}function a(){return!!o()&&!!localStorage.getItem("foldr_user_id")}async function l(e,t){try{let r=await fetch("".concat(s,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),o=await r.json();if(o.success&&o.token&&o.userId)return localStorage.setItem("foldr_auth_token",o.token),localStorage.setItem("foldr_user_id",o.userId),localStorage.setItem("foldr_user_email",e),{success:!0,userId:o.userId,token:o.token};return{success:!1,error:o.error||"Login failed"}}catch(e){return{success:!1,error:"Network error - working offline"}}}async function n(e,t){try{let r=await fetch("".concat(s,"/auth/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),o=await r.json();if(o.success&&o.token&&o.userId)return localStorage.setItem("foldr_auth_token",o.token),localStorage.setItem("foldr_user_id",o.userId),localStorage.setItem("foldr_user_email",e),{success:!0,userId:o.userId,token:o.token};return{success:!1,error:o.error||"Signup failed"}}catch(e){return{success:!1,error:"Network error"}}}function c(){localStorage.removeItem("foldr_auth_token"),localStorage.removeItem("foldr_user_id"),localStorage.removeItem("foldr_user_email")}async function i(){let e=o();if(!e)return{success:!1,error:"Not logged in"};try{let t={trips:localStorage.getItem("foldr_trips"),blocks:localStorage.getItem("foldr_blocks"),todos:localStorage.getItem("foldr_todos"),packingItems:localStorage.getItem("foldr_packing_items"),expenses:localStorage.getItem("foldr_expenses"),settings:localStorage.getItem("foldr_settings")},r=await fetch("".concat(s,"/sync/push"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(t)}),o=await r.json();if(o.success)return localStorage.setItem("foldr_last_sync",new Date().toISOString()),{success:!0};return{success:!1,error:o.error||"Sync failed"}}catch(e){return{success:!1,error:"Network error - will sync when online"}}}async function u(){let e=o();if(!e)return{success:!1,error:"Not logged in"};try{let t=await fetch("".concat(s,"/sync/pull"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}),r=await t.json();if(r.success)return r.trips&&localStorage.setItem("foldr_trips",r.trips),r.blocks&&localStorage.setItem("foldr_blocks",r.blocks),r.todos&&localStorage.setItem("foldr_todos",r.todos),r.packingItems&&localStorage.setItem("foldr_packing_items",r.packingItems),r.expenses&&localStorage.setItem("foldr_expenses",r.expenses),r.settings&&localStorage.setItem("foldr_settings",r.settings),localStorage.setItem("foldr_last_sync",new Date().toISOString()),{success:!0};return{success:!1,error:r.error||"Sync failed"}}catch(e){return{success:!1,error:"Network error - working offline"}}}async function d(){let e=await u();return e.success||"Network error - working offline"===e.error?await i():e}function g(){return localStorage.getItem("foldr_last_sync")}function m(){return localStorage.getItem("foldr_user_email")}},35695:(e,t,r)=>{"use strict";var s=r(18999);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},40662:(e,t,r)=>{Promise.resolve().then(r.bind(r,51628))},51628:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(95155),o=r(12115),a=r(35695),l=r(6874),n=r.n(l),c=r(33741);function i(){let e=(0,a.useRouter)(),[t,r]=(0,o.useState)("login"),[l,i]=(0,o.useState)(""),[u,d]=(0,o.useState)(""),[g,m]=(0,o.useState)(""),[f,h]=(0,o.useState)(""),[p,x]=(0,o.useState)(!1),b=async r=>{if(r.preventDefault(),h(""),x(!0),"signup"===t&&u!==g){h("Passwords do not match"),x(!1);return}try{let r="login"===t?await (0,c.iD)(l,u):await (0,c.$5)(l,u);r.success?(await (0,c.Vv)(),e.push("/trips")):h(r.error||"Authentication failed")}catch(e){h("Network error - please try again")}finally{x(!1)}};return(0,s.jsx)("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"w-full max-w-sm",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)(n(),{href:"/",children:(0,s.jsx)("img",{src:"/logos/logo.png",alt:"Foldr",className:"h-12 w-auto mx-auto mb-4",onError:e=>{let t=e.target;t.style.display="none",t.insertAdjacentHTML("afterend",'<span class="text-3xl font-bold" style="color: #6B9AE8">Foldr</span>')}})}),(0,s.jsx)("p",{className:"text-slate-400",children:"login"===t?"Sign in to sync your trips":"Create an account to sync your trips"})]}),(0,s.jsxs)("form",{onSubmit:b,className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[f&&(0,s.jsx)("div",{className:"bg-red-500/20 border border-red-500/50 text-red-400 px-4 py-3 rounded-lg mb-4 text-sm",children:f}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1.5",children:"Email"}),(0,s.jsx)("input",{type:"email",value:l,onChange:e=>i(e.target.value),required:!0,className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2.5 text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"you@example.com"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1.5",children:"Password"}),(0,s.jsx)("input",{type:"password",value:u,onChange:e=>d(e.target.value),required:!0,minLength:6,className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2.5 text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"••••••••"})]}),"signup"===t&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1.5",children:"Confirm Password"}),(0,s.jsx)("input",{type:"password",value:g,onChange:e=>m(e.target.value),required:!0,minLength:6,className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2.5 text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"••••••••"})]})]}),(0,s.jsx)("button",{type:"submit",disabled:p,className:"w-full mt-6 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-600/50 text-white font-medium py-2.5 rounded-lg transition-colors flex items-center justify-center gap-2",children:p?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"login"===t?"Signing in...":"Creating account..."]}):"login"===t?"Sign In":"Create Account"})]}),(0,s.jsx)("p",{className:"text-center mt-4 text-slate-400 text-sm",children:"login"===t?(0,s.jsxs)(s.Fragment,{children:["Don't have an account?"," ",(0,s.jsx)("button",{onClick:()=>{r("signup"),h("")},className:"text-blue-400 hover:text-blue-300",children:"Sign up"})]}):(0,s.jsxs)(s.Fragment,{children:["Already have an account?"," ",(0,s.jsx)("button",{onClick:()=>{r("login"),h("")},className:"text-blue-400 hover:text-blue-300",children:"Sign in"})]})}),(0,s.jsx)("p",{className:"text-center mt-6",children:(0,s.jsx)(n(),{href:"/trips",className:"text-slate-500 hover:text-slate-400 text-sm",children:"Continue without account →"})})]})})}}},e=>{e.O(0,[874,441,964,358],()=>e(e.s=40662)),_N_E=e.O()}]);